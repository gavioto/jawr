<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-01-05 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140105" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Jawr - Debug and production modes</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.1.min.js"></script>

              
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Java web resources bundling and compression</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-01-05
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 3.5
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">About</li>
                              
      <li>
  
                          <a href="../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                
      <li>
  
                          <a href="../introduction.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="../features.html" title="Features">
          <i class="none"></i>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../changes.html" title="Change history">
          <i class="none"></i>
        Change history</a>
            </li>
                
      <li>
  
                          <a href="../team.html" title="The team">
          <i class="none"></i>
        The team</a>
            </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../docs/servlet.html" title="The Jawr servlet">
          <i class="none"></i>
        The Jawr servlet</a>
            </li>
                
      <li>
  
                          <a href="../docs/descriptor_syntax.html" title="Descriptor syntax">
          <i class="none"></i>
        Descriptor syntax</a>
            </li>
                
      <li>
  
                          <a href="../docs/custom_bundles.html" title="Bundle definition">
          <i class="none"></i>
        Bundle definition</a>
            </li>
                
      <li>
  
                          <a href="../docs/source_ordering.html" title="Source order in bundles">
          <i class="none"></i>
        Source order in bundles</a>
            </li>
                
      <li>
  
                          <a href="../docs/cacheManager.html" title="Cache manager">
          <i class="none"></i>
        Cache manager</a>
            </li>
                
      <li>
  
                          <a href="../docs/global_preprocessors.html" title="Global preprocessors">
          <i class="none"></i>
        Global preprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/global_postprocessors.html" title="Global postprocessors">
          <i class="none"></i>
        Global postprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/postprocessors.html" title="Postprocessors">
          <i class="none"></i>
        Postprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/generators.html" title="Generators">
          <i class="none"></i>
        Generators</a>
            </li>
                
      <li>
  
                          <a href="../docs/advanced_generators.html" title="Advanced generators">
          <i class="none"></i>
        Advanced generators</a>
            </li>
                
      <li>
  
                          <a href="../docs/license_files.html" title="Licenses in resources">
          <i class="none"></i>
        Licenses in resources</a>
            </li>
                
      <li>
  
                          <a href="../docs/taglibs.html" title="JSP Tag library">
          <i class="none"></i>
        JSP Tag library</a>
            </li>
                
      <li>
  
                          <a href="../docs/plain_html.html" title="Use in HTML pages">
          <i class="none"></i>
        Use in HTML pages</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Debug and production modes</a>
          </li>
                
      <li>
  
                          <a href="../docs/messages_gen.html" title="i18n message generator">
          <i class="none"></i>
        i18n message generator</a>
            </li>
                
      <li>
  
                          <a href="../docs/variant_bundle.html" title="Variant bundles">
          <i class="none"></i>
        Variant bundles</a>
            </li>
                
      <li>
  
                          <a href="../docs/illegalBundleRequestHander.html" title="Jawr strict mode - Illegal bundle request handler">
          <i class="none"></i>
        Jawr strict mode - Illegal bundle request handler</a>
            </li>
                
      <li>
  
                          <a href="../docs/jmx_support.html" title="JMX Support">
          <i class="none"></i>
        JMX Support</a>
            </li>
                
      <li>
  
                          <a href="../docs/bundle_preprocessing.html" title="Bundle preprocessing">
          <i class="none"></i>
        Bundle preprocessing</a>
            </li>
                
      <li>
  
                          <a href="../docs/jawr_maven_plugin.html" title="Jawr Maven plugin">
          <i class="none"></i>
        Jawr Maven plugin</a>
            </li>
                
      <li>
  
                          <a href="../docs/jawr_ant_task.html" title="Jawr Ant task">
          <i class="none"></i>
        Jawr Ant task</a>
            </li>
                
      <li>
  
                          <a href="../migrationGuide.html" title="Migration Guide">
          <i class="none"></i>
        Migration Guide</a>
            </li>
                              <li class="nav-header">Integration</li>
                              
      <li>
  
                          <a href="../integration/augmenter.html" title="Add Jawr to your framework">
          <i class="none"></i>
        Add Jawr to your framework</a>
            </li>
                
      <li>
  
                          <a href="../integration/spring.html" title="Spring MVC">
          <i class="none"></i>
        Spring MVC</a>
            </li>
                
      <li>
  
                          <a href="../integration/facelets.html" title="Facelets Tag library">
          <i class="none"></i>
        Facelets Tag library</a>
            </li>
                
      <li>
  
                          <a href="../integration/wicket.html" title="Wicket">
          <i class="none"></i>
        Wicket</a>
            </li>
                
      <li>
  
                          <a href="../integration/grails.html" title="Grails plugin">
          <i class="none"></i>
        Grails plugin</a>
            </li>
                
      <li>
  
                          <a href="../integration/dwr.html" title="DWR">
          <i class="none"></i>
        DWR</a>
            </li>
                
      <li>
  
                          <a href="../integration/validator.html" title="Commons Validator - Struts">
          <i class="none"></i>
        Commons Validator - Struts</a>
            </li>
                              <li class="nav-header">Tutorials</li>
                              
      <li>
  
                          <a href="../tutorials/quickstart.html" title="Quick start">
          <i class="none"></i>
        Quick start</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrToServeImage.html" title="How to use Jawr to serve image resources">
          <i class="none"></i>
        How to use Jawr to serve image resources</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrCssSkin.html" title="How to use Jawr to generate CSS skin">
          <i class="none"></i>
        How to use Jawr to generate CSS skin</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/jawrSpriteImage.html" title="How to generate Image sprites with Jawr">
          <i class="none"></i>
        How to generate Image sprites with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrToGenerateBase64Image.html" title="How to generate base64 images in CSS with Jawr">
          <i class="none"></i>
        How to generate base64 images in CSS with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseGoogleClosureCompiler.html" title="How to use Google Closure Compiler with Jawr">
          <i class="none"></i>
        How to use Google Closure Compiler with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/faq_howto.html" title="FAQ-Howto">
          <i class="none"></i>
        FAQ-Howto</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/libraries.html" title="Using popular libraries">
          <i class="none"></i>
        Using popular libraries</a>
            </li>
                              <li class="nav-header">API and sources</li>
                              
      <li>
  
                          <a href="../nonav/apidocs/index.html" title="JavaDocs">
          <i class="none"></i>
        JavaDocs</a>
            </li>
                
      <li>
  
                          <a href="../nonav/xref/index.html" title="Source XREF">
          <i class="none"></i>
        Source XREF</a>
            </li>
                              <li class="nav-header">Project tools</li>
                              
      <li>
  
                          <a href="../servlets/ProjectHome" title="Project home">
          <i class="none"></i>
        Project home</a>
            </li>
                
      <li>
  
                          <a href="../team.html" title="Membership">
          <i class="none"></i>
        Membership</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/forums" class="externalLink" title="Discussion forums">
          <i class="none"></i>
        Discussion forums</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/lists" class="externalLink" title="Mailing lists">
          <i class="none"></i>
        Mailing lists</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/downloads/directory/release" class="externalLink" title="Documents & files">
          <i class="none"></i>
        Documents & files</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/sources" class="externalLink" title="Subversion">
          <i class="none"></i>
        Subversion</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/jira/browse/JAWR" class="externalLink" title="Issue tracker">
          <i class="none"></i>
        Issue tracker</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>Debug and production modes<a name="Debug_and_production_modes"></a></h2>
<p>Jawr was designed to be able to use bundled resources without losing the ability to use a fast development environment. Bundling resources together and minimizing them by removing whitespace and comments is great for production servers, but trying to debug a minified script that lacks comments is not going to make anyone's life easier. Also, if the strict caching policy that Jawr uses for production was used in development, you would basically need to clear your browser's cache every time you changed a line in a CSS or in a script to be able to test your changes. &#160; Thus, when you activate Jawr development mode, things change in the way Jawr works to make your life as a developer a lot easier. &#160;</p>
<p>To toggle debug mode, you can set the flag jawr.debug.on in the config file. </p><hr />
<p>While running in production mode, you may view your bundles in debug mode by using jawr.debug.overrideKey. This can be very helpfull when you need to debug issues in a production environment. Simply append overrideKey=(jawr.debug.overrideKey value) to the end of the url. Now your production bundles will be exploded; but only for that request. You may also view individual css and js files by adding the overrideKey to the end of the request.</p><hr />
<p>You can also start the virtual machine setting the config key net.jawr.debug.on (-Dnet.jawr.debug.on=false, for instance). The JVM config param will always take precedence over the key in the config file, so it's a good idea to use it within the startup script of your production server. This way, you will never deploy Jawr in debug mode by mistake. </p><hr />
<p>The main difference between production and development modes is that bundle files are not served directly. Rather, each of the components in a bundle will be served sepparately in the same order that it would be included in the bundle. To understand this, we need an example. Imagine we had a very simple directory structure like this one: </p><img src="../images/modes/sample_dirs.png" alt="A sample directory structure" />
<p>As you see, there is a sorting file in the /lib directory. This file is forcing prototype.js to be the first added to a bundle. &#160;</p>
<p>For this structure, we define two bundles in the following form: </p>
<div class="source">
<pre>        jawr.js.bundle.globalBundle.id=/bundles/global.js
        jawr.js.bundle.globalBundle.global=true
        jawr.js.bundle.globalBundle.mappings=/js/lib/** 
        jawr.js.bundle.globalBundle.prefix=/global01
        
        jawr.js.bundle.fooBundle.id=/bundles/fooBundle.js
        jawr.js.bundle.fooBundle.mappings=/js/foo.js,/js/bar.js 
        jawr.js.bundle.fooBundle.prefix=/foo01
</pre></div>
<p>Finally, we invoke a bundle in a page: </p>
<div class="source">
<pre>
        &lt;%@ taglib uri=&quot;http://jawr.net/tags&quot; prefix=&quot;jwr&quot; %&gt;
        &lt;html&gt;
        &lt;head&gt;
                &lt;!-- Invoking the fooBundle by using the path of one of its members --&gt;
                &lt;jwr:script src=&quot;/js/bar.js&quot;/&gt; 
        &lt;/head&gt;
        ...
        
</pre></div>
<p>Now, visiting this page has a very different effect depending on the mode Jawr is running. In production mode, the output is very straightforward: </p>
<div class="source">
<pre>        &lt;script type=&quot;text/javascript&quot; src=&quot;/myWarContext/global01/bundles/global.js&quot; &gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;/myWarContext/foo01/bundles/fooBundle.js&quot; &gt;&lt;/script&gt;
</pre></div>
<p>We get the global bundle first, then the one we invoked, as expected. &#160;</p>
<p>However, if we open the same page while in development mode, the output would look like this: </p>
<div class="source">
<pre>        &lt;script&gt;/*Start adding members resolved by '/js/bar.js'. Bundle id is: '/bundles/fooBundle.js'*/ &lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;/myWarContext/lib/prototype.js?d=1864721312&quot; &gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;/myWarContext/lib/sound.js?d=4725551312&quot; &gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;/myWarContext/lib/slider.js?d=2131218647&quot; &gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;/myWarContext/js/foo.js?d=7186421312&quot; &gt;&lt;/script&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;/myWarContext/js/bar.js?d=6418721312&quot; &gt;&lt;/script&gt;
        &lt;script&gt;/*Finished adding members resolved by /js/bar.js */&lt;/script&gt;
</pre></div>
<p>There are major differences here: </p>
<ul>
<li>Jawr writes javascript comments to let you know how each tag is being processed. This way you have better understanding of how bundles are resolved. </li>
<li>Instead of links to the bundles, we get links to the individual members of the bundles. These appear in the same order as they would when added to the bundle. Thus, the first link is to prototype.js since it belongs to the global bundle and the sorting file at the /lib directory states that it should precede the others. </li>
<li>The URL prefix for the bundles is omitted. </li>
<li>A request parameter with a random value is appended at the end of each URL. The effect is that no matter which your browser's cache settings are, the files will always be requested every time you refresh the page. </li>
<li>The files will be served as deployed, meaning no minification or postprocessing whatsoever will be applied, so you can work with them easily. </li>
<li>The Jawr servlet will not cache any resource, so if you are working with an exploded WAR deployment, you can change individual resources and see the changes without having to fully redeploy your application.</li></ul>
<p>The caveat here is very clear: never forget to switch off development mode in production or the results might be catastrophic for your bandwidth. As stated before, it's a good idea to use the JVM param <b>-Dnet.jawr.debug.on=false</b> within the startup script of your production server to be safe against this kind of mistake. Also, it is recommended that you have at least one integration step previous to production where you don't use development mode. &#160;</p>
<p>To further protect you from this kind of problem, a warning is written to the log anytime you start Jawr in development mode. </p>
<p><b>Warning</b>: Internet explorer has a <a class="externalLink" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;262161">30 stylesheet limit</a>. This means that in debug mode you might hit this limit if you have bundles that join over 30 stylesheets, since after the 30th IE will no longer parse and execute further stylesheets. Keep this in mind when developing your CSS files. </p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                   2014.
          All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
