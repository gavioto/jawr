<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-01-04 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140104" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Jawr - Illegal Bundle Request Handler</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.1.min.js"></script>

              
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Java web resources bundling and compression</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-01-04
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 3.5
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">About</li>
                              
      <li>
  
                          <a href="../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                
      <li>
  
                          <a href="../introduction.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="../features.html" title="Features">
          <i class="none"></i>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../changes.html" title="Change history">
          <i class="none"></i>
        Change history</a>
            </li>
                
      <li>
  
                          <a href="../team.html" title="The team">
          <i class="none"></i>
        The team</a>
            </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../docs/servlet.html" title="The Jawr servlet">
          <i class="none"></i>
        The Jawr servlet</a>
            </li>
                
      <li>
  
                          <a href="../docs/descriptor_syntax.html" title="Descriptor syntax">
          <i class="none"></i>
        Descriptor syntax</a>
            </li>
                
      <li>
  
                          <a href="../docs/custom_bundles.html" title="Bundle definition">
          <i class="none"></i>
        Bundle definition</a>
            </li>
                
      <li>
  
                          <a href="../docs/source_ordering.html" title="Source order in bundles">
          <i class="none"></i>
        Source order in bundles</a>
            </li>
                
      <li>
  
                          <a href="../docs/cacheManager.html" title="Cache manager">
          <i class="none"></i>
        Cache manager</a>
            </li>
                
      <li>
  
                          <a href="../docs/global_preprocessors.html" title="Global preprocessors">
          <i class="none"></i>
        Global preprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/global_postprocessors.html" title="Global postprocessors">
          <i class="none"></i>
        Global postprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/postprocessors.html" title="Postprocessors">
          <i class="none"></i>
        Postprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/generators.html" title="Generators">
          <i class="none"></i>
        Generators</a>
            </li>
                
      <li>
  
                          <a href="../docs/advanced_generators.html" title="Advanced generators">
          <i class="none"></i>
        Advanced generators</a>
            </li>
                
      <li>
  
                          <a href="../docs/license_files.html" title="Licenses in resources">
          <i class="none"></i>
        Licenses in resources</a>
            </li>
                
      <li>
  
                          <a href="../docs/taglibs.html" title="JSP Tag library">
          <i class="none"></i>
        JSP Tag library</a>
            </li>
                
      <li>
  
                          <a href="../docs/plain_html.html" title="Use in HTML pages">
          <i class="none"></i>
        Use in HTML pages</a>
            </li>
                
      <li>
  
                          <a href="../docs/modes.html" title="Debug and production modes">
          <i class="none"></i>
        Debug and production modes</a>
            </li>
                
      <li>
  
                          <a href="../docs/messages_gen.html" title="i18n message generator">
          <i class="none"></i>
        i18n message generator</a>
            </li>
                
      <li>
  
                          <a href="../docs/variant_bundle.html" title="Variant bundles">
          <i class="none"></i>
        Variant bundles</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Jawr strict mode - Illegal bundle request handler</a>
          </li>
                
      <li>
  
                          <a href="../docs/jmx_support.html" title="JMX Support">
          <i class="none"></i>
        JMX Support</a>
            </li>
                
      <li>
  
                          <a href="../docs/bundle_preprocessing.html" title="Bundle preprocessing">
          <i class="none"></i>
        Bundle preprocessing</a>
            </li>
                
      <li>
  
                          <a href="../docs/jawr_maven_plugin.html" title="Jawr Maven plugin">
          <i class="none"></i>
        Jawr Maven plugin</a>
            </li>
                
      <li>
  
                          <a href="../docs/jawr_ant_task.html" title="Jawr Ant task">
          <i class="none"></i>
        Jawr Ant task</a>
            </li>
                              <li class="nav-header">Integration</li>
                              
      <li>
  
                          <a href="../integration/augmenter.html" title="Add Jawr to your framework">
          <i class="none"></i>
        Add Jawr to your framework</a>
            </li>
                
      <li>
  
                          <a href="../integration/spring.html" title="Spring MVC">
          <i class="none"></i>
        Spring MVC</a>
            </li>
                
      <li>
  
                          <a href="../integration/facelets.html" title="Facelets Tag library">
          <i class="none"></i>
        Facelets Tag library</a>
            </li>
                
      <li>
  
                          <a href="../integration/wicket.html" title="Wicket">
          <i class="none"></i>
        Wicket</a>
            </li>
                
      <li>
  
                          <a href="../integration/grails.html" title="Grails plugin">
          <i class="none"></i>
        Grails plugin</a>
            </li>
                
      <li>
  
                          <a href="../integration/dwr.html" title="DWR">
          <i class="none"></i>
        DWR</a>
            </li>
                
      <li>
  
                          <a href="../integration/validator.html" title="Commons Validator - Struts">
          <i class="none"></i>
        Commons Validator - Struts</a>
            </li>
                              <li class="nav-header">Tutorials</li>
                              
      <li>
  
                          <a href="../tutorials/quickstart.html" title="Quick start">
          <i class="none"></i>
        Quick start</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrToServeImage.html" title="How to use Jawr to serve image resources">
          <i class="none"></i>
        How to use Jawr to serve image resources</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrCssSkin.html" title="How to use Jawr to generate CSS skin">
          <i class="none"></i>
        How to use Jawr to generate CSS skin</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/jawrSpriteImage.html" title="How to generate Image sprites with Jawr">
          <i class="none"></i>
        How to generate Image sprites with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrToGenerateBase64Image.html" title="How to generate base64 images in CSS with Jawr">
          <i class="none"></i>
        How to generate base64 images in CSS with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseGoogleClosureCompiler.html" title="How to use Google Closure Compiler with Jawr">
          <i class="none"></i>
        How to use Google Closure Compiler with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/faq_howto.html" title="FAQ-Howto">
          <i class="none"></i>
        FAQ-Howto</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/libraries.html" title="Using popular libraries">
          <i class="none"></i>
        Using popular libraries</a>
            </li>
                              <li class="nav-header">API and sources</li>
                              
      <li>
  
                          <a href="../nonav/apidocs/index.html" title="JavaDocs">
          <i class="none"></i>
        JavaDocs</a>
            </li>
                
      <li>
  
                          <a href="../nonav/xref/index.html" title="Source XREF">
          <i class="none"></i>
        Source XREF</a>
            </li>
                              <li class="nav-header">Project tools</li>
                              
      <li>
  
                          <a href="../servlets/ProjectHome" title="Project home">
          <i class="none"></i>
        Project home</a>
            </li>
                
      <li>
  
                          <a href="../team.html" title="Membership">
          <i class="none"></i>
        Membership</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/forums" class="externalLink" title="Discussion forums">
          <i class="none"></i>
        Discussion forums</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/lists" class="externalLink" title="Mailing lists">
          <i class="none"></i>
        Mailing lists</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/downloads/directory/release" class="externalLink" title="Documents & files">
          <i class="none"></i>
        Documents & files</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/sources" class="externalLink" title="Subversion">
          <i class="none"></i>
        Subversion</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/jira/browse/JAWR" class="externalLink" title="Issue tracker">
          <i class="none"></i>
        Issue tracker</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>Jawr illegal bundle request handler <a name="Jawr_illegal_bundle_request_handler"></a></h2>
<p>Since the version 3.3, Jawr introduced a new configuration setting which is the <b>strict mode</b>.<br />This <b>strict mode</b> refers to the way how Jawr handles the bundle request where the bundle exist in Jawr but the identifier of the bundle (hashcode) doesn't match the existing one.</p>
<p>This case can happen when you have an application which runs on 2 servers, and that you're deploying a new version of your application on one server, while the other is still running.<br />It can happen that the user retrieve the content of the page from one server, and try to retrieve the bundle resources from the other. If the requested bundle has different between the 2 servers, Jawr will receive a request for a bundle which exists but where the hashcode is incorrect.<br />If you set the strict mode property in your Jawr configuration file to true, Jawr allows you to define the handler for such request. Here are the properties which you can use to handle the strict mode : </p>
<table border="1" class="table table-striped">
<tr class="a">
<td align="left"><b>Property name</b></td>
<td align="left"><b>Type</b></td>
<td align="left"><b>Purpose</b></td>
<td align="left"><b>Default value</b></td></tr>
<tr class="b">
<td align="left">jawr.strict.mode</td>
<td align="left">Boolean</td>
<td align="left">Enable/disable strict mode for bundle request.</td>
<td align="left">False</td></tr>
<tr class="a">
<td align="center">jawr.illegal.bundle.request.handler</td>
<td align="center">String</td>
<td align="left">The class name of the handler for illegal bundle request.</td>
<td align="left">net.jawr.web.servlet.IllegalBundleRequestHandlerImpl</td></tr></table><img src="../images/illegalBundleRequestHandler/illegalBundleRequestHandler.jpg" alt="Illegal bundle request handler class diagram." />
<p>The IllegalBundleRequestHandler defines the following methods :</p>
<div class="source">
<pre>        /**
         * This method can update the response header and 
         * returns true if the header has been written 
         * and false if Jawr must write the response header.
         * @param requestedPath the requested path
         * @param request the request
         * @param response the response
         * @return true if the header has been written 
         * and false if Jawr must write the response header.
         * @throws IOException if an IOException occurs
         */
        boolean writeResponseHeader(String requestedPath, HttpServletRequest request, HttpServletResponse response) throws IOException;
        
        /**
         * This method should return true if Jawr should send back the content of the bundle.
         * @param requestedPath the requested path
         * @param request the request
         * @return true if if Jawr should send back the content of the bundle.
         */
        boolean canWriteContent(String requestedPath, HttpServletRequest request);
        
</pre></div>
<ul>
<li><b>boolean writeResponseHeader(String requestedPath, HttpServletRequest request, HttpServletResponse response)</b><br />This method is used to update the response header is needed. It must returns true if the response header has been written and false to let Jawr handles the response header like for correct bundle. </li>
<li><b>boolean canWriteContent(String requestedPath, HttpServletRequest request)</b><br />This method is used to determine if Jawr should send back the matching bundle content or not.</li></ul>
<div class="section">
<h3>Jawr default IllegalBundleRequestHandler implementation<a name="Jawr_default_IllegalBundleRequestHandler_implementation"></a></h3>
<p>Jawr provides a default implementation of the IllegalBundleRequestHandler, which returns a 404 if the bundle hashcode doesn't match. </p>
<div class="source">
<pre>        /* (non-Javadoc)
         * @see net.jawr.web.servlet.IllegalBundleRequestHandler#writeResponseHeader(java.lang.String, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse)
         */
        public boolean writeResponseHeader(String requestedPath,
                        HttpServletRequest request, HttpServletResponse response) throws IOException {
                
                response.sendError(HttpServletResponse.SC_NOT_FOUND);
                return true;
        }

        /* (non-Javadoc)
         * @see net.jawr.web.servlet.IllegalBundleRequestHandler#canWriteContent(java.lang.String, javax.servlet.http.HttpServletRequest)
         */
        public boolean canWriteContent(String requestedPath,
                        HttpServletRequest request) {
                return false;
        }
</pre></div></div>
<div class="section">
<h3>Custom IllegalBundleRequestHandler implementation<a name="Custom_IllegalBundleRequestHandler_implementation"></a></h3>
<p>To create your own IllegalBundleRequestHandler, you must create a class which implements IllegalBundleRequestHandler.</p>
<p>Then in the Jawr configuration file you should add the following setting:</p>
<div class="source">
<pre>jawr.strict.mode=true
jawr.illegal.bundle.request.handler=com.mycomp.jawr.MyIllegalBundleRequestHandler       
</pre></div>
<p>Here <b>com.mycomp.jawr.MyIllegalBundleRequestHandler</b> is the class name of your IllegalBundleRequestHandler</p></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                   2014.
          All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
