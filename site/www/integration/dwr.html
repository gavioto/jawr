<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-04-19 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140419" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Jawr - DWR integration</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.1.min.js"></script>

              
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Java web resources bundling and compression</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-04-19
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 3.5.1
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">About</li>
                              
      <li>
  
                          <a href="../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                
      <li>
  
                          <a href="../introduction.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="../features.html" title="Features">
          <i class="none"></i>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../changes.html" title="Change history">
          <i class="none"></i>
        Change history</a>
            </li>
                
      <li>
  
                          <a href="../team.html" title="The team">
          <i class="none"></i>
        The team</a>
            </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../docs/servlet.html" title="The Jawr servlet">
          <i class="none"></i>
        The Jawr servlet</a>
            </li>
                
      <li>
  
                          <a href="../docs/descriptor_syntax.html" title="Descriptor syntax">
          <i class="none"></i>
        Descriptor syntax</a>
            </li>
                
      <li>
  
                          <a href="../docs/custom_bundles.html" title="Bundle definition">
          <i class="none"></i>
        Bundle definition</a>
            </li>
                
      <li>
  
                          <a href="../docs/source_ordering.html" title="Source order in bundles">
          <i class="none"></i>
        Source order in bundles</a>
            </li>
                
      <li>
  
                          <a href="../docs/cacheManager.html" title="Cache manager">
          <i class="none"></i>
        Cache manager</a>
            </li>
                
      <li>
  
                          <a href="../docs/global_preprocessors.html" title="Global preprocessors">
          <i class="none"></i>
        Global preprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/global_postprocessors.html" title="Global postprocessors">
          <i class="none"></i>
        Global postprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/postprocessors.html" title="Postprocessors">
          <i class="none"></i>
        Postprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/generators.html" title="Generators">
          <i class="none"></i>
        Generators</a>
            </li>
                
      <li>
  
                          <a href="../docs/advanced_generators.html" title="Advanced generators">
          <i class="none"></i>
        Advanced generators</a>
            </li>
                
      <li>
  
                          <a href="../docs/license_files.html" title="Licenses in resources">
          <i class="none"></i>
        Licenses in resources</a>
            </li>
                
      <li>
  
                          <a href="../docs/taglibs.html" title="JSP Tag library">
          <i class="none"></i>
        JSP Tag library</a>
            </li>
                
      <li>
  
                          <a href="../docs/plain_html.html" title="Use in HTML pages">
          <i class="none"></i>
        Use in HTML pages</a>
            </li>
                
      <li>
  
                          <a href="../docs/modes.html" title="Debug and production modes">
          <i class="none"></i>
        Debug and production modes</a>
            </li>
                
      <li>
  
                          <a href="../docs/messages_gen.html" title="i18n message generator">
          <i class="none"></i>
        i18n message generator</a>
            </li>
                
      <li>
  
                          <a href="../docs/variant_bundle.html" title="Variant bundles">
          <i class="none"></i>
        Variant bundles</a>
            </li>
                
      <li>
  
                          <a href="../docs/illegalBundleRequestHander.html" title="Jawr strict mode - Illegal bundle request handler">
          <i class="none"></i>
        Jawr strict mode - Illegal bundle request handler</a>
            </li>
                
      <li>
  
                          <a href="../docs/jmx_support.html" title="JMX Support">
          <i class="none"></i>
        JMX Support</a>
            </li>
                
      <li>
  
                          <a href="../docs/bundle_preprocessing.html" title="Bundle preprocessing">
          <i class="none"></i>
        Bundle preprocessing</a>
            </li>
                
      <li>
  
                          <a href="../docs/jawr_maven_plugin.html" title="Jawr Maven plugin">
          <i class="none"></i>
        Jawr Maven plugin</a>
            </li>
                
      <li>
  
                          <a href="../docs/jawr_ant_task.html" title="Jawr Ant task">
          <i class="none"></i>
        Jawr Ant task</a>
            </li>
                
      <li>
  
                          <a href="../migrationGuide.html" title="Migration Guide">
          <i class="none"></i>
        Migration Guide</a>
            </li>
                              <li class="nav-header">Integration</li>
                              
      <li>
  
                          <a href="../integration/augmenter.html" title="Add Jawr to your framework">
          <i class="none"></i>
        Add Jawr to your framework</a>
            </li>
                
      <li>
  
                          <a href="../integration/spring.html" title="Spring MVC">
          <i class="none"></i>
        Spring MVC</a>
            </li>
                
      <li>
  
                          <a href="../integration/facelets.html" title="Facelets Tag library">
          <i class="none"></i>
        Facelets Tag library</a>
            </li>
                
      <li>
  
                          <a href="../integration/wicket.html" title="Wicket">
          <i class="none"></i>
        Wicket</a>
            </li>
                
      <li>
  
                          <a href="../integration/grails.html" title="Grails plugin">
          <i class="none"></i>
        Grails plugin</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>DWR</a>
          </li>
                
      <li>
  
                          <a href="../integration/validator.html" title="Commons Validator - Struts">
          <i class="none"></i>
        Commons Validator - Struts</a>
            </li>
                              <li class="nav-header">Tutorials</li>
                              
      <li>
  
                          <a href="../tutorials/quickstart.html" title="Quick start">
          <i class="none"></i>
        Quick start</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrToServeImage.html" title="How to use Jawr to serve image resources">
          <i class="none"></i>
        How to use Jawr to serve image resources</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrCssSkin.html" title="How to use Jawr to generate CSS skin">
          <i class="none"></i>
        How to use Jawr to generate CSS skin</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/jawrSpriteImage.html" title="How to generate Image sprites with Jawr">
          <i class="none"></i>
        How to generate Image sprites with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrToGenerateBase64Image.html" title="How to generate base64 images in CSS with Jawr">
          <i class="none"></i>
        How to generate base64 images in CSS with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseGoogleClosureCompiler.html" title="How to use Google Closure Compiler with Jawr">
          <i class="none"></i>
        How to use Google Closure Compiler with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/faq_howto.html" title="FAQ-Howto">
          <i class="none"></i>
        FAQ-Howto</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/libraries.html" title="Using popular libraries">
          <i class="none"></i>
        Using popular libraries</a>
            </li>
                              <li class="nav-header">API and sources</li>
                              
      <li>
  
                          <a href="../nonav/apidocs/index.html" title="JavaDocs">
          <i class="none"></i>
        JavaDocs</a>
            </li>
                
      <li>
  
                          <a href="../nonav/xref/index.html" title="Source XREF">
          <i class="none"></i>
        Source XREF</a>
            </li>
                              <li class="nav-header">Project tools</li>
                              
      <li>
  
                          <a href="../servlets/ProjectHome" title="Project home">
          <i class="none"></i>
        Project home</a>
            </li>
                
      <li>
  
                          <a href="../team.html" title="Membership">
          <i class="none"></i>
        Membership</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/forums" class="externalLink" title="Discussion forums">
          <i class="none"></i>
        Discussion forums</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/lists" class="externalLink" title="Mailing lists">
          <i class="none"></i>
        Mailing lists</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/downloads/directory/release" class="externalLink" title="Documents & files">
          <i class="none"></i>
        Documents & files</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/projects/jawr/sources" class="externalLink" title="Subversion">
          <i class="none"></i>
        Subversion</a>
            </li>
                
      <li>
  
                          <a href="http://java.net/jira/browse/JAWR" class="externalLink" title="Issue tracker">
          <i class="none"></i>
        Issue tracker</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>Using DWR with Jawr<a name="Using_DWR_with_Jawr"></a></h2>
<p><a class="externalLink" href="http://directwebremoting.org/dwr/index.html">DWR</a> (Direct Web Remoting) is a java library which allows Javascript in a browser to interact with Java on a server and helps you manipulate web pages with the results. </p>
<p>DWR works by setting up one or several servlets which serve javascript and also convert AJAX requests to java class method invocations. The javascript served by DWR is either one of several static .js files or a generated javascript stub that allows method calls to be routed to the server via AJAX. </p>
<p>DWR already has a method to minify and compress javascript, but Jawr adds extra functionality so that you serve your resources more consistently. Specifically, with JAWR you can serve all the static .js files in one bundle. You can also combine these with other scripts. For instance, you could have a javascript bundle containng Prototype.js, script.aculo.us, your own infrastructure and the DWR static scripts. </p>
<p>Also, you can bundle together the generated javascript stubs which normally must be requested separately. For pages that use several remote objects, this can speed up loading. </p>
<p>Finally, using this approach you have a consistent way of serving all javascript, instead of using different methods to serve DWR scripts or Jawr bundles. </p>
<p>Jawr supports DWR 2.x using the <i>jawr-dwr2.x-extension</i> extension module. Maven users can add a dependency as the following: </p>
<div class="source">
<pre>        
    &lt;dependency&gt;
      &lt;groupId&gt;net.jawr.extensions&lt;/groupId&gt;
      &lt;artifactId&gt;jawr-dwr2.x-extension&lt;/artifactId&gt;
      &lt;version&gt;3.5&lt;/version&gt;
    &lt;/dependency&gt;
    
</pre></div>
<p>There is a sample application that you can download to chek out how integration with DWR works, which you can download from <a class="externalLink" href="https://svn.java.net/svn/jawr~svn/extensions/dwr2.x/trunk/jawr-dwr2.x-webapp-sample">this link</a>. </p>
<p>Jawr supports also DWR 3.x using the <i>jawr-dwr3.x-extension</i> extension module. Maven users can add a dependency as the following: </p>
<div class="source">
<pre>
    &lt;dependency&gt;
      &lt;groupId&gt;net.jawr.extensions&lt;/groupId&gt;
      &lt;artifactId&gt;jawr-dwr3.x-extension&lt;/artifactId&gt;
      &lt;version&gt;3.5-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
    
</pre></div>
<p>As the DWR 3.x library is still in SNAPSHOT version, the <i>jawr-dwr3.x-extension</i> is also in SNAPSHOT version. This module has been released on the Sonatype snapshot repository (https://oss.sonatype.org/).</p>
<p>Please use the snapshot repository by adding the following section in your pom :</p>
<div class="source">
<pre>
&lt;distributionManagement&gt;
  &lt;snapshotRepository&gt;
    &lt;id&gt;sonatype-nexus-snapshots&lt;/id&gt;
    &lt;name&gt;Sonatype Nexus Snapshots&lt;/name&gt;
    &lt;url&gt;https://oss.sonatype.org/content/repositories/snapshots/&lt;/url&gt;
  &lt;/snapshotRepository&gt;
&lt;/distributionManagement&gt;

</pre></div>
<div class="section">
<h3>Set up<a name="Set_up"></a></h3>
<p>The jawr servlet must be started after the DWR one. To make sure this order is followed, you must set up the <i>load-on-startup</i> parameter so that the value for the Jawr servlet is greater than the one for the DWR servlet: </p>
<div class="source">
<pre>
        &lt;servlet&gt;
           &lt;servlet-name&gt;dwr-invoker&lt;/servlet-name&gt;
           &lt;display-name&gt;DWR Servlet&lt;/display-name&gt;
           &lt;description&gt;Direct Web Remoter Servlet&lt;/description&gt;
           &lt;servlet-class&gt;org.directwebremoting.servlet.DwrServlet&lt;/servlet-class&gt;
           ...
           &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;-- Loads first 
        &lt;/servlet&gt;
  
        &lt;servlet&gt;
                &lt;servlet-name&gt;JavascriptServlet&lt;/servlet-name&gt;
                &lt;servlet-class&gt;net.jawr.web.servlet.JawrServlet&lt;/servlet-class&gt;
           ...
           &lt;load-on-startup&gt;2&lt;/load-on-startup&gt; &lt;-- Loads after DWR
        &lt;/servlet&gt;
        
</pre></div>
<p>Jawr needs to know the sevlet mapping that points to DWR. Therefore, in the properties config you must set up the <b>jawr.dwr.mapping</b> parameter to the same value (without the wildcard) that you use for the DWR servlet: </p>
<div class="source">
<pre>
  Web.xml: 
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dwr-invoker&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/dwr/*&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;
  
  Jawr.properties:
  jawr.dwr.mapping=/dwr/
  
</pre></div>
<div class="section">
<h4>Additional DWR servlet instances<a name="Additional_DWR_servlet_instances"></a></h4>
<p>If you declare more than one DWR servlet, Jawr will need to access the additional mappings for these. In this case, for every additional servlet you must add a special init-param, named <b>jawr_mapping</b>. The value, again, must be the servlet-mapping used for the servlet, without the wildcard. Note that this init-param is added to the DWR servlet config, <b>not</b> the Jawr servlet config. </p>
<div class="source">
<pre>
   &lt;servlet&gt;
    &lt;servlet-name&gt;additional-dwr-invoker&lt;/servlet-name&gt;
    &lt;display-name&gt;DWR Servlet&lt;/display-name&gt;
    &lt;description&gt;Direct Web Remoter Servlet&lt;/description&gt;
    &lt;servlet-class&gt;org.directwebremoting.servlet.DwrServlet&lt;/servlet-class&gt;
    ...
    &lt;init-param&gt;
            &lt;param-name&gt;jawr_mapping&lt;/param-name&gt;
            &lt;param-value&gt;/other/dwr/&lt;/param-value&gt; &lt;-- Matches servlet-mapping
    &lt;/init-param&gt;
    ...
   &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;additional-dwr-invoker&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/other/dwr/*&lt;/url-pattern&gt; &lt;-- Use in jawr_mapping
  &lt;/servlet-mapping&gt;
   
</pre></div>
<p>You need to do this for additional DWR servlets, but you can skip it for the one to which mapping you point in the <b>jawr.dwr.mapping</b> param. You can't skip using this param though, since it acts as a flag to Jawr indicating that DWR integration is on. </p></div></div>
<div class="section">
<h3>DWR generator and JS link renderer :<a name="DWR_generator_and_JS_link_renderer_:"></a></h3>
<p>A specific generator is used for dwr resources (check below for more information on dwr resources). Prior to the 3.5 version, this generator was a built-in generator, now users must declare it specifically in their jawr configuration file. To render the DWR bundles properly, the declaration of a specific DWR JS bundle link renderer is needed. </p>
<p>For dwr 2.x, users will need to use the following configuration :</p>
<div class="source">
<pre>
        # Configure DWR generator and DWR link renderer
        jawr.custom.generators=net.jawr.web.resource.bundle.generator.dwr.DWRBeanGenerator
        jawr.js.bundle.link.renderer.class=net.jawr.web.resource.bundle.renderer.DWRJsBundleLinkRenderer

</pre></div>
<p>For dwr 3.x, users will need to use the following configuration :</p>
<div class="source">
<pre>
        # Configure DWR generator and DWR link renderer
        jawr.custom.generators=net.jawr.web.resource.bundle.generator.dwr.DWR3BeanGenerator
        jawr.js.bundle.link.renderer.class=net.jawr.web.resource.bundle.renderer.DWRJsBundleLinkRenderer

</pre></div></div>
<div class="section">
<h3>Maping DWR resources in bundles<a name="Maping_DWR_resources_in_bundles"></a></h3>
<p>Once you have performed setup, you can start using DWR beans in your bundle mappings. All DWR resources are mapped using the special prefix '<b>dwr:</b>', which is the prefix for a specific generator. As stated before, DWR has several static resources that you will probably want to bundle with the rest of your javascript infrastructure code (Prototype, YUI or whichever, etc). You map to these using several special keywords: </p>
<table border="1" class="table table-striped">
<tr class="a">
<td align="left"><b>Keyword</b></td>
<td align="left"><b>DWR script</b></td></tr>
<tr class="b">
<td align="left">dwr:_engine</td>
<td align="left">engine.js</td></tr>
<tr class="a">
<td align="left">dwr:_util</td>
<td align="left">util.js</td></tr>
<tr class="b">
<td align="left">dwr:_auth</td>
<td align="left">auth.js</td></tr>
<tr class="a">
<td align="left">dwr:_actionutil</td>
<td align="left">DWRActionUtil.js (webwork integration)</td></tr></table>
<p>The engine.js script should always be included first since others depend on it. Note that this file is not completaly static, since DWR generates some variables depending on the user's request. This is not optimal, since users will get a new copy on every new session with the application. Jawr solves this by generating these parameters in a very small inline script that contains only the dynamic variables. </p>
<p>So in a typical use case, you would define your DWR generator, a specific Javascript LinkRenderer and add these to a global bundle: </p>
<div class="source">
<pre>        # Configure DWR generator and DWR link renderer
        jawr.custom.generators=net.jawr.web.resource.bundle.generator.dwr.DWRBeanGenerator
        jawr.js.bundle.link.renderer.class=net.jawr.web.resource.bundle.renderer.DWRJsBundleLinkRenderer

        # Configure DWR bundle
        jawr.js.bundle.global.id=/bundles/global.js
        jawr.js.bundle.global.mappings=/js/protaculous/**, dwr:_engine, dwr:_util
        jawr.js.bundle.global.global=true
</pre></div>
<p>To add DWR beans (the javascript stubs to access java objects in the server), you use the <b>dwr:</b> prefix followed by the name you specified in the dwr.xml config file (or in the alternate configuration method of your choice). </p>
<p>For instance, the following mapping adds two of these beans to a bundle:</p>
<div class="source">
<pre>
    dwr.xml: 
    &lt;create creator=&quot;new&quot; javascript=&quot;People&quot; scope=&quot;script&quot;&gt; &lt;-- Use the value of the 'javascript' attribute
      &lt;param name=&quot;class&quot; value=&quot;org.getahead.dwrdemo.people.People&quot;/&gt;
    &lt;/create&gt;
        &lt;create creator=&quot;new&quot; javascript=&quot;LiveHelp&quot; scope=&quot;application&quot;&gt;
      &lt;param name=&quot;class&quot; value=&quot;org.getahead.dwrdemo.livehelp.LiveHelp&quot;/&gt;
    &lt;/create&gt;
    
    jawr.config:
    jawr.js.bundle.mybundle.mappings=dwr:People, dwr:LiveHelp
        
</pre></div>
<p>Note that Jawr does not support having several DWR servlets that map to beans with the same names. You can't declare two DWR servlets with a bean named 'Person', for instance. </p>
<p>One last thing you can do is to bundle <b>all</b> dwr beans into one bundle. To do this, tou use the special keyword <b>dwr:_**</b>: </p>
<div class="source">
<pre>   This adds all beans defined in dwr.xml: 
   jawr.js.bundle.alldwrbeans.mappings=dwr:_**
        
</pre></div>
<p>Be aware that this mapping does not include the static DWR scripts, only the bean stubs. Here is an example of an all-in-one DWR bundle: </p>
<div class="source">
<pre>        jawr.js.bundle.dwrall.id=/bundles/dwrall.js
        jawr.js.bundle.dwrall.mappings=dwr:_engine, dwr:_util,dwr:_auth, dwr:_**        
</pre></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                   2014.
          All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
