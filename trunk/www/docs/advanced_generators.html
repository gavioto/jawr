<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">










<html>
  <head>
    <title>Jawr - Advanced Generators</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <!-- TODO: move this into JavaScript to patch the skin
      <div class="xright">  </div>
    -->
    <div id="leftColumn">
      <div id="navcolumn">
             <dl class=navgroup>
        <dt>About</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../servlets/ProjectHome">Home</a>
        </li>
              
    <li class="none">
              <a href="../introduction.html">Introduction</a>
        </li>
              
    <li class="none">
              <a href="../features.html">Features</a>
        </li>
              
    <li class="none">
              <a href="../changes.html">Change history</a>
        </li>
              
    <li class="none">
              <a href="../team.html">The team</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Documentation</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../docs/servlet.html">The Jawr servlet</a>
        </li>
              
    <li class="none">
              <a href="../docs/descriptor_syntax.html">Descriptor syntax</a>
        </li>
              
    <li class="none">
              <a href="../docs/custom_bundles.html">Bundle definition</a>
        </li>
              
    <li class="none">
              <a href="../docs/source_ordering.html">Source order in bundles</a>
        </li>
              
    <li class="none">
              <a href="../docs/global_preprocessors.html">Global preprocessors</a>
        </li>
              
    <li class="none">
              <a href="../docs/postprocessors.html">Postprocessors</a>
        </li>
              
    <li class="none">
              <a href="../docs/generators.html">Generators</a>
        </li>
              
    <li class="none">
              <strong>Advanced generators</strong>
        </li>
              
    <li class="none">
              <a href="../docs/license_files.html">Licenses in resources</a>
        </li>
              
    <li class="none">
              <a href="../docs/taglibs.html">JSP Tag library</a>
        </li>
              
    <li class="none">
              <a href="../docs/plain_html.html">Use in HTML pages</a>
        </li>
              
    <li class="none">
              <a href="../docs/modes.html">Debug and production modes</a>
        </li>
              
    <li class="none">
              <a href="../docs/messages_gen.html">i18n message generator</a>
        </li>
              
    <li class="none">
              <a href="../docs/jmx_support.html">JMX Support</a>
        </li>
              
    <li class="none">
              <a href="../docs/bundle_preprocessing.html">Bundle preprocessing</a>
        </li>
              
    <li class="none">
              <a href="../docs/jawr_maven_plugin.html">Jawr Maven plugin</a>
        </li>
              
    <li class="none">
              <a href="../docs/jawr_ant_task.html">Jawr Ant task</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Integration</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../integration/augmenter.html">Add Jawr to your framework</a>
        </li>
              
    <li class="none">
              <a href="../integration/spring.html">Spring MVC</a>
        </li>
              
    <li class="none">
              <a href="../integration/facelets.html">Facelets Tag library</a>
        </li>
              
    <li class="none">
              <a href="../integration/wicket.html">Wicket</a>
        </li>
              
    <li class="none">
              <a href="../integration/grails.html">Grails plugin</a>
        </li>
              
    <li class="none">
              <a href="../integration/dwr.html">DWR</a>
        </li>
              
    <li class="none">
              <a href="../integration/validator.html">Commons Validator - Struts</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Tutorials</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../tutorials/quickstart.html">Quick start</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/howToUseJawrToServeImage.html">How to use Jawr to serve image resources</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/jawrSpriteImage.html">How to generate Image sprites with Jawr</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/faq_howto.html">FAQ-Howto</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/libraries.html">Using popular libraries</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>API and sources</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../nonav/apidocs/index.html">JavaDocs</a>
        </li>
              
    <li class="none">
              <a href="../nonav/xref/index.html">Source XREF</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Project tools</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../servlets/ProjectHome">Project home</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectMemberList">Membership</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectNewsList">Announcements</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectForumView">Discussion forums</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectMailingListList">Mailing lists</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectDocumentList">Documents & files</a>
        </li>
              
    <li class="none">
              <a href="../source/browse/jawr/">Subversion</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectIssues">Issue tracker</a>
        </li>
          </ul></dd>
    </dl>
        </div>
      <script>
        // replace the java.net project tools with the navigation bar from Maven.
        // also get rid of "Get Involved" thingie too, while we are at it
        var pt = document.getElementById("projecttools");
        var nv = document.getElementById("navcolumn");
        
        while(pt.previousSibling!=null)
          pt.parentNode.removeChild(pt.previousSibling);
        
        pt.parentNode.insertBefore(nv,pt);
        pt.parentNode.removeChild(pt);
      </script>
      <script>
        // kill "description" h3 bar
        var ld = document.getElementById("longdescription");
        if(ld!=null) {
          for( n=ld.firstChild; n!=null; n=n.nextSibling ) {
            if(n.nodeType==1 && n.innerHTML=="Description" ) {
              n.parentNode.removeChild(n);
              break;
            }
          }
        }
      </script>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Jawr Advanced Generators</h2>
<p>Please make sure to read the <a href="./generators.html">Jawr Generators documentation</a> before this page.<br />
In the <a href="./generators.html">Jawr Generators documentation</a>, we have seen how to implement a basic generator. <br />
Here we will see advanced features about the generators.</p>
<div class="section"><h3>Initialization of a generator</h3>
<p>In the Jawr configuration file, we only define the class name of the generator.<br />
Jawr provides some interfaces to initialize the generator.</p>
<img src="../images/generator/jawr_initializingGenerator.png" alt="Initializing Generator class diagram" /><p>In the class diagram above, we can see that there are 3 main interfaces for generator initialization.</p>
<ul><li><b>net.jawr.web.resource.bundle.generator.ConfigurationAwareResourceGenerator</b><br />
This interface provides a method to set the Jawr configuration in the generator.<div class="source"><pre>        public void setConfig(JawrConfig config);</pre>
</div>
</li>
<li><b>net.jawr.web.resource.bundle.generator.TypeAwareResourceGenerator</b><br />
This interface provides a method to set the type of resource, which the generator will handle. This interface is useful if you are using one generator class to generate different type of resources (JS and CSS).<p>For example : For a resource generator which is able to handle Javascript files and CSS files.<br />
If the type is &quot;js&quot; then the debugModePath will be &quot;/jawr_generator.js&quot; <br />
else if the type is &quot;css&quot; the debugModePath will be &quot;/jawr_generator.css&quot;</p>
<div class="source"><pre>        public void setResourceType(String resourceType);</pre>
</div>
</li>
<li><b>net.jawr.web.resource.bundle.generator.PostInitializationAwareResourceGenerator</b><br />
This interface provides a method, which is called at the end of the generator initialization.<div class="source"><pre>        public void afterPropertiesSet();</pre>
</div>
</li>
</ul>
</div>
<div class="section"><h3>Locale aware generator</h3>
<p>Jawr allows you to create generators, which can create resources depending on the user locale.</p>
<p>There is one locale aware generator, which is already provided In Jawr, and which handles i18n message resources : </p>
<ul><li><b>i18n messages script generator</b> generates javascript code with locale specific variants which are loaded depending on the user's specific language. Full documentation is <a href="./messages_gen.html">here</a>. </li>
</ul>
<p>So Jawr provides a mechanism to define a generator which can generate resources with locale specific variants.<br />
You will find below the class diagram for the locale aware resource generator.</p>
<img src="../images/generator/jawr_variantResourceGenerator.png" alt="Variant Resource Generator class diagram" /><ul><li><b>net.jawr.web.resource.bundle.generator.LocaleAwareResourceGenerator</b><br />
This interface provides a method, which is called to know what are the available locale variants for a path.<div class="source"><pre>        public List getAvailableLocales(String mapping);</pre>
</div>
<p>For example, if you have 3 differents locale variant for a CSS stylesheet like:<br />
general.css, general_fr.css, general_en.css</p>
<p>Your generator must return a list of String corresponding to the available locale variants, in our case : (&quot;&quot;, &quot;fr&quot;, &quot;en&quot;) </p>
</li>
</ul>
</div>
<div class="section"><h3>CSS Resource generator</h3>
<p>As for every resource, Jawr allows you to create a generator for the CSS files.<br />
One of the particularity of the CSS resources, is that they have references to images.</p>
<p>With Jawr, you are free to define a CSS Resource generator, which is also an Image Resource generator.&#160; If your CSS generator is able to handle generated image resources, it must implements <b>net.jawr.web.resource.bundle.generator.StreamResourceGenerator</b> </p>
<p>For example, you can have a CSS resource which is defined in the classpath. This CSS can have references to images which are also retrieved from the classpath. <br />
So here you define that your CSS resource generator will also handle CSS images.<br />
All references to images will be handled by the CSS resource generator.</p>
<p>You will find below the class diagram for Css Resource Generator [../images/generator/jawr_cssGenerator.png] CSS Generator class diagram</p>
<ul><li><b>net.jawr.web.resource.bundle.generator.CssResourceGenerator</b><br />
This interface is implemented by the resource generator, which generates CSS resources.<div class="source"><pre>        public boolean isHandlingCssImage();</pre>
</div>
<p>This method must return true if the CSS image defined in the generated CSS resource are handled by the CSS generator.</p>
<p>For example, If <b>myCssGen</b> is the prefix of the resource generator, all CSS image which are defined in the CSS resources, will be prefixed by <b>myCssGen</b>.<br />
If in the generated CSS resource, a CSS image is referenced as</p>
<p><b>background-image : url('/myImg/temp/myIcon.png')</b></p>
<p>Then, the image path will be interpreted as :</p>
<p><b>background-image : url('myGen:/myImg/temp/myIcon.png')</b></p>
<p><b>Important note :</b> If your generator handle CSS resources, you are not forced to implement the <b>net.jawr.web.resource.bundle.generator.CssResourceGenerator</b> interface. You will need implement it only if your CSS generator is able to handle CSS images. </p>
</li>
</ul>
</div>
<div class="section"><h3>Generator Resource mapping</h3>
<p>There are three ways to map resources:</p>
<ul><li>Directly by resource path: simply type the relative path to the resource, starting at the root of the WAR file, as in: '/js/foo.js'.</li>
<li>By directory, non-recurring: add the path to a directory and every resource under it will be added to the bundle, as in: '/js/'.</li>
<li>By directory, recurring: same as before but adding '**' at the end. This will add every resource under the specified directory and any directory below it. For example: '/js/**'.<p>For example:</p>
<div class="source"><pre>        jawr.js.bundle.myBundle.id=/bundles/myBundle.js
        jawr.js.bundle.myBundle.mappings=/js/one.js,/js/tabview/**</pre>
</div>
<p>In the above example, we have referenced the resource <b>/js/on.js</b> directly, and we have also put all js files available under <b>/js/tabview/</b> folder.</p>
<p>With the resource generator, you can achieve the same behaviours. By default, the resource generator is only able to handle the direct reference to a resource path, like in the example below :</p>
<div class="source"><pre>        jawr.js.bundle.myBundle.id=/bundles/myBundle.js
        jawr.js.bundle.myBundle.mappings=myGen:/js/one.js</pre>
</div>
<p>If you want to use the <i>directory</i> syntax for generated resource, your generator must implement the interface <b>net.jawr.web.resource.handler.reader.ResourceBrowser</b>, like the <b>GeneratedResourceBrowser</b> interface defined below.</p>
<img src="../images/generator/jawr_resourceBrowserGenerator.png" alt="Resource Browser interface" /><ul><li><b>net.jawr.web.resource.handler.reader.ResourceBrowser</b><br />
This interface is implemented by the generators, which are able to handle hierachical generated resource search.<div class="source"><pre>        public Set getResourceNames(String path);</pre>
</div>
<p>This method returns a list of resources at a specified path within the resources directory.</p>
<div class="source"><pre>        public boolean isDirectory(String path);</pre>
</div>
<p>Determines wether a given path is a directory. </p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section"><h3>Debug mode for generated Resource deployed in CDN</h3>
<p>Jawr allows you to reference bundled resources deployed in a content delivery network (CDN). <br />
To achieve this, you need to use the properties <b>jawr.url.contextpath.override</b> and <b>jawr.url.contextpath.ssl.override</b>. <br />
Even in debug mode, Jawr allows you to reference resources in a CDN using the property <b>jawr.url.contextpath.override.used.in.debug.mode</b>. <br />
Jawr helps you to create the resources and the structure of the files to put in your CDN using the <a href="./bundle_preprocessing.html">build time processing feature</a>. <br />
When using the <a href="./bundle_preprocessing.html">build time processing feature</a> allows you to define the path used for storing the generated resources. <br />
To define the path of a generated resource in debug mode, the generator must implement a specific interface.</p>
<ul><li><b>net.jawr.web.resource.bundle.generator.SpecificCDNDebugPathResourceGenerator</b><p>This interface is implemented by the resource generators which are able to define a specific path for the debug mode in the <b>build time bundle processing</b>.</p>
<div class="source"><pre>        public String getDebugModeBuildTimeGenerationPath(String parameter);</pre>
</div>
<p>This methods must return the path to use when creating a generated resource in debug mode during the <b>build time bundle processing</b>.</p>
</li>
</ul>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2010
    
          
  

  
  
  &nbsp;| Last Published: 01/31/2010
  &nbsp;| Version: 3.2.1
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
