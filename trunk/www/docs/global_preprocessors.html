<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">










<html>
  <head>
    <title>Jawr - Global Preprocessors</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <!-- TODO: move this into JavaScript to patch the skin
      <div class="xright">  </div>
    -->
    <div id="leftColumn">
      <div id="navcolumn">
             <dl class=navgroup>
        <dt>About</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../servlets/ProjectHome">Home</a>
        </li>
              
    <li class="none">
              <a href="../introduction.html">Introduction</a>
        </li>
              
    <li class="none">
              <a href="../features.html">Features</a>
        </li>
              
    <li class="none">
              <a href="../changes.html">Change history</a>
        </li>
              
    <li class="none">
              <a href="../team.html">The team</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Documentation</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../docs/servlet.html">The Jawr servlet</a>
        </li>
              
    <li class="none">
              <a href="../docs/descriptor_syntax.html">Descriptor syntax</a>
        </li>
              
    <li class="none">
              <a href="../docs/custom_bundles.html">Bundle definition</a>
        </li>
              
    <li class="none">
              <a href="../docs/source_ordering.html">Source order in bundles</a>
        </li>
              
    <li class="none">
              <strong>Global preprocessors</strong>
        </li>
              
    <li class="none">
              <a href="../docs/postprocessors.html">Postprocessors</a>
        </li>
              
    <li class="none">
              <a href="../docs/generators.html">Generators</a>
        </li>
              
    <li class="none">
              <a href="../docs/advanced_generators.html">Advanced generators</a>
        </li>
              
    <li class="none">
              <a href="../docs/license_files.html">Licenses in resources</a>
        </li>
              
    <li class="none">
              <a href="../docs/taglibs.html">JSP Tag library</a>
        </li>
              
    <li class="none">
              <a href="../docs/plain_html.html">Use in HTML pages</a>
        </li>
              
    <li class="none">
              <a href="../docs/modes.html">Debug and production modes</a>
        </li>
              
    <li class="none">
              <a href="../docs/messages_gen.html">i18n message generator</a>
        </li>
              
    <li class="none">
              <a href="../docs/jmx_support.html">JMX Support</a>
        </li>
              
    <li class="none">
              <a href="../docs/bundle_preprocessing.html">Bundle preprocessing</a>
        </li>
              
    <li class="none">
              <a href="../docs/jawr_maven_plugin.html">Jawr Maven plugin</a>
        </li>
              
    <li class="none">
              <a href="../docs/jawr_ant_task.html">Jawr Ant task</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Integration</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../integration/augmenter.html">Add Jawr to your framework</a>
        </li>
              
    <li class="none">
              <a href="../integration/spring.html">Spring MVC</a>
        </li>
              
    <li class="none">
              <a href="../integration/facelets.html">Facelets Tag library</a>
        </li>
              
    <li class="none">
              <a href="../integration/wicket.html">Wicket</a>
        </li>
              
    <li class="none">
              <a href="../integration/grails.html">Grails plugin</a>
        </li>
              
    <li class="none">
              <a href="../integration/dwr.html">DWR</a>
        </li>
              
    <li class="none">
              <a href="../integration/validator.html">Commons Validator - Struts</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Tutorials</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../tutorials/quickstart.html">Quick start</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/howToUseJawrToServeImage.html">How to use Jawr to serve image resources</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/jawrSpriteImage.html">How to generate Image sprites with Jawr</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/faq_howto.html">FAQ-Howto</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/libraries.html">Using popular libraries</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>API and sources</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../nonav/apidocs/index.html">JavaDocs</a>
        </li>
              
    <li class="none">
              <a href="../nonav/xref/index.html">Source XREF</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Project tools</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../servlets/ProjectHome">Project home</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectMemberList">Membership</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectNewsList">Announcements</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectForumView">Discussion forums</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectMailingListList">Mailing lists</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectDocumentList">Documents & files</a>
        </li>
              
    <li class="none">
              <a href="../source/browse/jawr/">Subversion</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectIssues">Issue tracker</a>
        </li>
          </ul></dd>
    </dl>
        </div>
      <script>
        // replace the java.net project tools with the navigation bar from Maven.
        // also get rid of "Get Involved" thingie too, while we are at it
        var pt = document.getElementById("projecttools");
        var nv = document.getElementById("navcolumn");
        
        while(pt.previousSibling!=null)
          pt.parentNode.removeChild(pt.previousSibling);
        
        pt.parentNode.insertBefore(nv,pt);
        pt.parentNode.removeChild(pt);
      </script>
      <script>
        // kill "description" h3 bar
        var ld = document.getElementById("longdescription");
        if(ld!=null) {
          for( n=ld.firstChild; n!=null; n=n.nextSibling ) {
            if(n.nodeType==1 && n.innerHTML=="Description" ) {
              n.parentNode.removeChild(n);
              break;
            }
          }
        }
      </script>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Jawr Global Preprocessors</h2>
<p>Global Preprocessors are filters that Jawr applies to resources during startup before the bundling process. In some cases, it is convenient to preprocess all the JS or CSS files before making the bundle process, because you need to gather information from all the files before making your bundling process.</p>
<p>Jawr provides one built-in global preprocessor, which handles the image sprite generation with smartsprites. Jawr uses a global preprocessor for the image sprite generation when using smartsprites, because this process requires to retrieve information from all the files before being able to generate the sprites. </p>
<p>You can create and use your own global preprocessor, so here is how to configure the filter chain for global preprocessing. </p>
<p>A global preprocessor will be only invoked once during application startup before the bundling and the post process phases. The point is to be able to make a treatment which need to be done on all the JS or CSS resources, before the bundling process. </p>
<p>For configuration purposes, every global preprocessor has a unique name key, which you use in a comma-separated property in the descriptor, for instance: </p>
<div class="source"><pre>        jawr.css.bundle.factory.global.preprocessors=smartsprites,myGlobalPreprocessor
                </pre>
</div>
<p>In this example, the global preprocessors set for <b>css</b> resources are <i>smartsprites</i> and <i>myGlobalPreprocessor</i>, meaning that the <b>smartsprites</b> and th <b>myGlobalPreprocessor</b> global preprocessors will be processed for all css resources. The <i>smartsprites</i> global preprocessor will be executed before <i>myGlobalPreprocessor</i>. </p>
<div class="section"><h3>Custom global preprocessor</h3>
<p>You can also implement your own global preprocessor components (for js, css, or both) to perform any functionality not offered by the included one. To do that, you must create a class with a no-params constructor that implements the interface <i>net.jawr.web.resource.bundle.global.preprocessor.GlobalPreprocessor</i>. This interface defines a single method: </p>
<div class="source"><pre>        /**
         * Process the bundles for a type of resources.
         *  
         * @param ctx the processing context
         * @param bundles the list of bundles to process.
         */
        public void processBundles(GlobalPreprocessingContext ctx, List bundles);</pre>
</div>
<p>The first parameter is an object which defines the global preprocessing context and also gives you acces to Jawr configuration plus other data which may be useful under certain circumstances. </p>
<p>The second parameter is the list of bundles defined in your configuration. </p>
<p>To use this global preprocessor in our application, we need to declare it in the properties configuration, by giving it a name and declaring the class so that Jawr may create an instance when starting up. The name you give to your global preprocessor can then be used to define the gobal factory properties, thus allowing you to create a chain that combines your global preprocessor with those of Jawr. </p>
<p>The name and class are defined by declaring a property in the form jawr.custom.global.preprocessor.[name].class=[class]. For example, the following configuration would add one custom global preprocessor named <i>myGlobalPreprocessor</i> and map to the css resources preprocessing chains: </p>
<div class="source"><pre>jawr.custom.global.preprocessor.myGlobalPreprocessor.class=net.jawr.test.MyGlobalPreprocessor

jawr.css.bundle.factory.global.preprocessors=myGlobalPreprocessor</pre>
</div>
<hr />
<p>Grails users will unfortunately need to pack their classes in a jar and add it to the lib folder of their application. The reason for this is a known flaw in the Grails classloading strategy that keeps plugins from accessing application classes.</p>
<hr />
</div>
<div class="section"><h3>Jawr included global preprocessors reference</h3>
</div>
</div>
<div class="section"><h2><b>Smartsprites Css image preprocessor</b></h2>
<ul><li><b>Properties Key</b>: smartsprites</li>
</ul>
<p>The smartsprites global preprocessor will generate the CSS sprites from the smartsprites annotation from the CSS files. Check the <a href="../tutorials/jawrSpriteImage.html">tutorial on jawr image sprites</a> for more info. </p>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2009
    
          
  

  
  
  &nbsp;| Last Published: 12/09/2009
  &nbsp;| Version: 3.2
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
